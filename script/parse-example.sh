#!/bin/bash

# 解析DNY协议示例日志数据的脚本

# 检查DNY解析器是否已编译
if [ ! -f "./bin/dny-parser" ]; then
    echo "DNY解析器未找到，正在编译..."
    make dny-parser
fi

# 示例数据数组
declare -a examples=(
    "3839383630344439313632333930343838323937"
    "444e590900f36ca2040200120d03"
    "444e595000f36ca204030011680202643437681a07383938363034443931363233393034383832393755000038363434353230363937363234373256312e302e30302e3030303030302e3036313600000000007c10"
    "444e591d00f36ca204b8010180022b0902000000000000000000000a00315d001705"
    "444e591200f36ca2040400350131008002f36ca204f405"
    "444e591000f36ca204b901212b09020000005d6e04"
    "444e591d00cd28a204a8010180022c0902000000000000000000001e00315a00af04"
    "444e590900f36ca204ba0122d603"
    "444e591000cd28a204a901212c09020000005af203"
    "444e590f00f36ca204bb01208002020a3106a004"
    "444e590f00cd28a204aa01208002021e31063904"
    "444e591d00cd28a204ab01018002280902000000000000000000001e00315a00ae04"
    "444e590f00f36ca204bc01208002020a3106a104"
    "444e591000cd28a204ac01212809020000005af103"
    "444e591d00f36ca204bd01018002270902000000000000000000000a00315d001805"
)

echo "解析示例DNY协议数据..."
echo ""

# 遍历并解析每个示例数据
for hex_data in "${examples[@]}"; do
    echo "十六进制数据: $hex_data"
    
    # 检查是否以DNY开头(444e59)
    if [[ $hex_data == 444e59* ]]; then
        echo "解析结果:"
        ./bin/dny-parser -hex "$hex_data"
    else
        echo "非DNY协议数据，跳过解析"
    fi
    
    echo "------------------------------------------"
done

echo "解析完成"
exit 0 