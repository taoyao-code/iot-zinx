# 删除不需要应答的指令

## 修改内容概述

根据通信协议规范，修改了部分不需要服务器应答的指令处理逻辑，并处理了旧格式心跳包的问题。

## 修改详情

### 1. 不需要应答的指令

根据协议规范，以下指令服务器无需应答：

- `0x11` (主机状态心跳包)：服务器无需应答
- `0x35` (上传分机版本号与设备类型)：服务器无需应答
- `0x81` (查询设备联网状态)：服务器无需应答

### 2. 修改文件

1. **pkg/protocol/sender.go**
   - 修改 `NeedConfirmation` 函数，将上述三个命令代码标记为不需要应答

2. **internal/infrastructure/zinx_server/handlers/main_heartbeat_handler.go**
   - 移除发送响应的代码
   - 保留心跳时间更新和日志记录

3. **internal/infrastructure/zinx_server/handlers/device_version_handler.go**
   - 移除发送响应的代码
   - 保留心跳时间更新和日志记录

4. **internal/infrastructure/zinx_server/handlers/device_status_handler.go**
   - 移除发送响应的代码
   - 保留心跳时间更新和日志记录

### 3. 旧格式心跳包处理

1. **internal/infrastructure/zinx_server/handlers/heartbeat_handler.go**
   - 添加旧格式心跳包的检测逻辑
   - 当检测到旧格式心跳包时（命令字为0x01，数据长度为20字节，或特定物理ID的设备），记录警告日志但不发送响应
   - 保留心跳时间更新功能

## 预期效果

1. 减少不必要的网络I/O和状态维护
2. 符合协议规范，使服务器行为更贴近协议文档
3. 减少网络流量

## 注意事项

1. 对于旧格式心跳包，保留了更新心跳时间的功能，确保设备连接状态正常维护
2. 所有修改都保留了关键的日志记录，便于监控和排查问题
3. 由于不再发送响应，需要密切关注这些设备的状态，确保它们的行为不依赖于服务器的响应 